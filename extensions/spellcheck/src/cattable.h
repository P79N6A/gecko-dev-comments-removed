







































#include "nscore.h" 

static const PRUint8 gGenCatIdx1[224] = {
      0,  
      0,  
      0,  
      0,  
      1,  
      2,  
      3,  
      4,  
      5,  
      6,  
      6,  
      7,  
      8,  
      6,  
      6,  
      9,  
      0,  
      0,  
      0,  
      0,  
     10,  
     11,  
     12,  
     13,  
      6,  
      6,  
     14,  
      6,  
      6,  
      6,  
     14,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     15,  
     16,  
      6,  
      6,  
      6,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     18,  
      6,  
     19,  
     20,  
     21,  
     20,  
     22,  
     23,  
     24,  
     17,  
     17,  
     25,  
     25,  
     25,  
     25,  
     25,  
     25,  
     25,  
     25,  
     26,  
     17,  
     17,  
     17,  
     27,  
     17,  
     28,  
     29,  
     30,  
     31,  
      6,  
      6,  
     32,  
      6,  
      6,  
      6,  
      6,  
     33,  
     33,  
     34,  
     35,  
      6,  
     36,  
     17,  
     37,  
     38,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     37,  
     38,  
      6,  
      6,  
      6,  
      6,  
     39,  
     17,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     40,  
     41,  
      6,  
      6,  
      6,  
     42,  
     15,  
     43,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     37,  
      6,  
      6,  
      6,  
     33,  
     44,  
     37,  
      6,  
      6,  
      6,  
      6,  
     45,  
     46,  
     25,  
     47,  
     25,  
     25,  
     48,  
     49,  
     17,  
      6,  
      6,  
      6,  
     50,  
     51,  
     17,  
     17,  
     52,  
     17,  
     53,  
     37,  
      6,  
      6,  
     50,  
      6,  
     54,  
     55,  
     17,  
      3,  
     56,  
     57,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     58,  
      6,  
     33,  
     59,  
     25,  
     60,  
     61,  
      3,  
     62,  
};

static const PRUint8 gGenCatIdx2[288] = {
     63,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     64,  
     25,  
     26,  
     65,  
      6,  
     66,  
      3,  
     67,  
     17,  
     63,  
     40,  
     68,  
      6,  
      6,  
     35,  
     69,  
     70,  
     71,  
     72,  
     73,  
     74,  
     75,  
      3,  
     76,  
     77,  
     78,  
     79,  
     68,  
      6,  
      6,  
     35,  
     80,  
     70,  
     81,  
     72,  
     17,  
     82,  
     83,  
      3,  
     84,  
     17,  
     63,  
     85,  
     32,  
      6,  
      6,  
     35,  
     86,  
     64,  
     87,  
     88,  
     18,  
     17,  
     89,  
      3,  
     17,  
     17,  
     63,  
     40,  
     68,  
      6,  
      6,  
     35,  
     90,  
     64,  
     91,  
     72,  
     92,  
     74,  
     93,  
      3,  
     94,  
     17,  
     95,  
     96,  
     97,  
     98,  
     99,  
     96,  
    100,  
    101,  
    102,  
    103,  
     73,  
     17,  
    104,  
      3,  
    105,  
     17,  
     63,  
     38,  
     35,  
      6,  
      6,  
     35,  
    106,  
    101,  
    107,  
    103,  
    108,  
     17,  
     93,  
      3,  
     17,  
     17,  
     95,  
     38,  
     35,  
      6,  
      6,  
     35,  
    106,  
    101,  
    107,  
    103,  
    108,  
    109,  
     93,  
      3,  
     17,  
     17,  
     95,  
     38,  
     35,  
      6,  
      6,  
     35,  
      6,  
    101,  
    110,  
    103,  
     73,  
     17,  
     93,  
      3,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     37,  
      6,  
      6,  
      6,  
      6,  
      6,  
    111,  
    112,  
    113,  
    114,  
      3,  
    115,  
     17,  
     17,  
     17,  
     17,  
    116,  
    117,  
    118,  
     37,  
    119,  
    120,  
    111,  
    121,  
    122,  
     26,  
      3,  
    123,  
     17,  
     17,  
     17,  
     17,  
    124,  
    125,  
    126,  
    127,  
      3,  
      3,  
    128,  
    129,  
      6,  
     37,  
      6,  
      6,  
      6,  
     43,  
     46,  
     25,  
    130,  
     36,  
     87,  
     46,  
     25,  
     26,  
     46,  
    131,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
      6,  
      6,  
      6,  
      6,  
     15,  
     17,  
      6,  
      6,  
      6,  
      6,  
     33,  
    132,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
    133,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     50,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     43,  
};

static const PRUint8 gGenCatIdx3[320] = {
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     36,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     43,  
      6,  
      6,  
     15,  
     15,  
      6,  
      6,  
      6,  
      6,  
     15,  
     15,  
      6,  
    134,  
      6,  
      6,  
      6,  
     15,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     38,  
    135,  
    136,  
     23,  
     42,  
    137,  
      6,  
     23,  
    138,  
    139,  
    140,  
    141,  
    125,  
    125,  
    125,  
    142,  
    125,  
    125,  
    143,  
     17,  
     17,  
     17,  
     17,  
    144,  
    145,  
    146,  
      3,  
    147,  
     17,  
     17,  
     21,  
    148,  
     17,  
     17,  
     17,  
     17,  
     25,  
     25,  
     27,  
     17,  
     17,  
     17,  
    149,  
    150,  
    151,  
    152,  
    153,  
    154,  
    155,  
     18,  
     17,  
     17,  
    156,  
      3,  
      3,  
      3,  
      3,  
      3,  
    105,  
     17,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
    157,  
     17,  
     17,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     24,  
     17,  
    158,  
     21,  
     21,  
     21,  
     21,  
    159,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
    157,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     21,  
     21,  
     21,  
     21,  
    148,  
     17,  
     17,  
     17,  
     21,  
    157,  
     17,  
     17,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
    160,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
    161,  
     17,  
     17,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
    162,  
     17,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     17,  
     17,  
     21,  
     21,  
    163,  
    164,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
    165,  
    166,  
     21,  
     21,  
     21,  
    167,  
     21,  
     21,  
     21,  
    168,  
    169,  
     22,  
    167,  
     17,  
     83,  
      3,  
      3,  
      3,  
    170,  
     21,  
     21,  
     21,  
    167,  
     22,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
};

static const PRUint8 gGenCatIdx4[128] = {
    171,  
    125,  
    172,  
    125,  
    173,  
    174,  
    175,  
    176,  
     37,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
    177,  
    178,  
     37,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
    179,  
    180,  
      6,  
      6,  
      6,  
      6,  
    177,  
     37,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     33,  
    181,  
     21,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     21,  
     21,  
     21,  
    148,  
      3,  
    182,  
     21,  
     21,  
    163,  
     17,  
     17,  
     17,  
     21,  
     21,  
     21,  
    183,  
      3,  
    182,  
     21,  
     21,  
     21,  
     21,  
     94,  
     17,  
     21,  
    163,  
     21,  
     21,  
     21,  
     21,  
     21,  
     22,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     22,  
    184,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
     21,  
    162,  
     21,  
     21,  
     21,  
     22,  
};

static const PRUint8 gGenCatIdx5[224] = {
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     15,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     17,  
     33,  
     17,  
    185,  
    186,  
      6,  
    154,  
     33,  
    122,  
    187,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     43,  
     17,  
     17,  
     17,  
    185,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
    188,  
     17,  
     17,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     16,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     17,  
     17,  
     17,  
     17,  
     17,  
      6,  
     36,  
     17,  
     17,  
     17,  
     17,  
    189,  
     17,  
    125,  
    125,  
    190,  
    191,  
    192,  
    125,  
    193,  
    194,  
     31,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
    195,  
    196,  
      2,  
      3,  
      4,  
      5,  
      6,  
      6,  
      7,  
      8,  
      6,  
      6,  
    197,  
    198,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
      6,  
     33,  
     16,  
     16,  
     16,  
    199,  
     22,  
     22,  
     17,  
    200,  
};

static PRUint32 gGenCatPat[201] = {
    0x44444444,  
    0x66676663,  
    0x66667666,  
    0x22222222,  
    0x67776622,  
    0x55555556,  
    0x55555555,  
    0x67666555,  
    0x55555557,  
    0x47676555,  
    0x77777763,  
    0x77676577,  
    0x67572277,  
    0x62226527,  
    0x75555555,  
    0x00555555,  
    0x55555500,  
    0x00000000,  
    0x00000005,  
    0x55555775,  
    0x77777755,  
    0x77777777,  
    0x07777777,  
    0x77755555,  
    0x00000077,  
    0x11111111,  
    0x00111111,  
    0x00000011,  
    0x00660000,  
    0x06000500,  
    0x65770000,  
    0x55050555,  
    0x55555055,  
    0x05555555,  
    0x05050500,  
    0x55555505,  
    0x00005555,  
    0x55555550,  
    0x55055555,  
    0x01111755,  
    0x50055555,  
    0x00055005,  
    0x55005555,  
    0x00000055,  
    0x66666650,  
    0x00000060,  
    0x11111110,  
    0x11111011,  
    0x16111011,  
    0x00016116,  
    0x00000555,  
    0x00066555,  
    0x00060000,  
    0x60006000,  
    0x11111555,  
    0x00000111,  
    0x00666622,  
    0x55555551,  
    0x05555500,  
    0x11565555,  
    0x15511111,  
    0x00111171,  
    0x00000022,  
    0x55501110,  
    0x11510055,  
    0x00011115,  
    0x22661155,  
    0x00000006,  
    0x55555005,  
    0x55000505,  
    0x11010055,  
    0x10011111,  
    0x00111001,  
    0x10000000,  
    0x50550000,  
    0x22001155,  
    0x22227755,  
    0x00000722,  
    0x55500100,  
    0x50000555,  
    0x05505505,  
    0x10000111,  
    0x05055550,  
    0x22000000,  
    0x00055511,  
    0x50505555,  
    0x55505505,  
    0x10111111,  
    0x00111011,  
    0x22000005,  
    0x55005505,  
    0x10001111,  
    0x11000000,  
    0x22000055,  
    0x00000007,  
    0x55501100,  
    0x55000555,  
    0x00555505,  
    0x55050550,  
    0x00055000,  
    0x50555555,  
    0x11000055,  
    0x11000111,  
    0x00111101,  
    0x20000000,  
    0x00000222,  
    0x55505555,  
    0x11011111,  
    0x01100000,  
    0x05000000,  
    0x11001111,  
    0x11115515,  
    0x70000111,  
    0x15555555,  
    0x71111111,  
    0x00006622,  
    0x50050550,  
    0x00500505,  
    0x55550000,  
    0x50505550,  
    0x55505500,  
    0x00511011,  
    0x05055555,  
    0x00550022,  
    0x66667775,  
    0x66666666,  
    0x77777666,  
    0x77777711,  
    0x17172222,  
    0x11666617,  
    0x11611111,  
    0x00000010,  
    0x00006000,  
    0x50000055,  
    0x50505050,  
    0x75755555,  
    0x55055577,  
    0x77705555,  
    0x55055500,  
    0x07755555,  
    0x33333333,  
    0x44443333,  
    0x04444433,  
    0x06676666,  
    0x44444400,  
    0x22220002,  
    0x56677722,  
    0x06677722,  
    0x00077777,  
    0x57777577,  
    0x55555577,  
    0x77575555,  
    0x77555555,  
    0x75757777,  
    0x55555575,  
    0x55555755,  
    0x22222000,  
    0x00000777,  
    0x77777707,  
    0x77777667,  
    0x77772222,  
    0x00000277,  
    0x00777777,  
    0x00007777,  
    0x77777700,  
    0x77077770,  
    0x77770077,  
    0x77777770,  
    0x70707777,  
    0x07000777,  
    0x00072222,  
    0x25576663,  
    0x66667766,  
    0x22222227,  
    0x11111122,  
    0x77555556,  
    0x70000000,  
    0x00055555,  
    0x05577110,  
    0x05556555,  
    0x55500000,  
    0x77222277,  
    0x77777722,  
    0x70007777,  
    0x77777000,  
    0x55555000,  
    0x51000000,  
    0x55055055,  
    0x66555555,  
    0x00001111,  
    0x00066666,  
    0x66666660,  
    0x66660666,  
    0x07776766,  
    0x00006676,  
    0x40055555,  
    0x66676660,  
    0x07676555,  
    0x55666660,  
    0x00055500,  
    0x00770000,  
};

static PRUint8 GetCat(PRUnichar u)
{
    PRUint32 pat;
    
    
    
    
    if( (u<=((PRUnichar)0x06FF))) {
        pat = gGenCatPat[gGenCatIdx1 [( u -(PRUnichar) 0x0000 ) / 8]];
        return (pat  >> ((u % 8) * 4)) & 0x0F;
    }

    
    if((((PRUnichar)0x0900)<=u)&&(u<=((PRUnichar)0x11FF))) {
        pat = gGenCatPat[gGenCatIdx2 [( u -(PRUnichar) 0x0900 ) / 8]];
        return (pat  >> ((u % 8) * 4)) & 0x0F;
    }

    
    if((((PRUnichar)0x1E00)<=u)&&(u<=((PRUnichar)0x27FF))) {
        pat = gGenCatPat[gGenCatIdx3 [( u -(PRUnichar) 0x1E00 ) / 8]];
        return (pat  >> ((u % 8) * 4)) & 0x0F;
    }

    
    if((((PRUnichar)0x3000)<=u)&&(u<=((PRUnichar)0x33FF))) {
        pat = gGenCatPat[gGenCatIdx4 [( u -(PRUnichar) 0x3000 ) / 8]];
        return (pat  >> ((u % 8) * 4)) & 0x0F;
    }

    
    if((((PRUnichar)0xF900)<=u)&&(u<=((PRUnichar)0xFFFF))) {
        pat = gGenCatPat[gGenCatIdx5 [( u -(PRUnichar) 0xF900 ) / 8]];
        return (pat  >> ((u % 8) * 4)) & 0x0F;
    }

    
    
    
    
    if((((PRUnichar)0x4E00)<=u)&&(u<=((PRUnichar)0x9FA5))) 
        return 5; 

    
    if((((PRUnichar)0xAC00)<=u)&&(u<=((PRUnichar)0xD7A3))) 
        return 5; 

    
    if((((PRUnichar)0xDC00)<=u)&&(u<=((PRUnichar)0xDFFF))) 
        return 4; 

    
    if((((PRUnichar)0xE000)<=u)&&(u<=((PRUnichar)0xF8FF))) 
        return 4; 

    
    if((((PRUnichar)0xDB80)<=u)&&(u<=((PRUnichar)0xDBFF))) 
        return 4; 

    
    if((((PRUnichar)0xD800)<=u)&&(u<=((PRUnichar)0xDB7F))) 
        return 4; 

    return 0; 
}

