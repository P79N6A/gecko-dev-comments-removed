<html>





































<title>nsIProperties Tets case</title>

<head>

<script type="text/javascript" src="http://www.mozilla.org/quality/embed/jstests/accessibility/jslib/bridge.js"> </script>

<script type="text/javascript">

var gPropObject ;
var buffer ;

function getPropertyObject()
{

	if (gPropObject)
	   return gPropObject ;

	try{
		netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");

		gPropObject = Components.classes["@mozilla.org/properties;1"].
				createInstance(Components.interfaces.nsIProperties)

		return gPropObject ;
	 }
	 catch(e){
		if (isRunningStandalone())
			alert("Exception: " + e);
		else
			WriteResults("Exception: " + e);
	  }

}

function WritePassFail(aValue,e)
{

  if( aValue ==  "Pass")
  {
	  buffer += "<td>"+  e  +"</td>" ;
	  buffer += "<td>Pass</td>"
  }
  else
  {
	  buffer += "<td>" +"Exception: " + e + "</td>" ;
	  buffer += "<td bgcolor='#FF0000'>Fail</td>"
  }

  buffer += "</tr>"

}

function RunAllTests()
{
	// "<td bgcolor='#FF0000'>

	buffer = "<b>Results for <a href='http://lxr.mozilla.org/seamonkey/source/xpcom/ds/nsIProperties.idl'>nsIProperties :</a></b><br><br>"
	buffer += "<table border cols=4 width='70%'>"
	buffer += "<tr>"
	buffer += "<td><b>Property/Method</b></td>"
	buffer += "<td><b>Params</b></td>"
	buffer += "<td><b>Bug/Error</b></td>"
	buffer += "<td><b>Result</b></td>"
	buffer += "</tr>"

	set();
	get();
	has();
	undefine();
	getKeys();

	buffer += "</table>"
	if (isRunningStandalone())
	{
	   document.clear();
	   document.write(buffer);
	}
	else
		WriteResults(buffer);
}

function set()
{
	var prop = getPropertyObject();
	buffer += "<tr>"
	buffer += "<td>set()</td>"
	buffer += "<td>Name, Value(nsISupports)</td>"
	try{
		netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");

		var ifaceReq = window.QueryInterface(Components.interfaces.nsIInterfaceRequestor).getInterface(Components.interfaces.nsIDOMWindow);
		prop.set("Name", ifaceReq);
		WritePassFail("Pass",ifaceReq);
	 }
	 catch(e){
			WritePassFail("Fail",e);
	  }
}

function get()
{
	var prop = getPropertyObject();
	buffer += "<tr>"
	buffer += "<td>get()</td>"
	buffer += "<td>Name, Type(nsISupports)</td>"
	try{

		netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");

		var abc =  prop.get("Name", Components.interfaces.nsIDOMWindow);
		WritePassFail("Pass",abc);
	 }
	 catch(e){
		WritePassFail("Fail",e);
	  }
}


function has()
{
	var prop = getPropertyObject();
	buffer += "<tr>"
	buffer += "<td>has()</td>"
	buffer += "<td>Name</td>"
	try{

		netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var bhas = prop.has("Name");
		if (bhas)
			WritePassFail("Pass","true");
		else
			WritePassFail("Pass","false");
	 }
	 catch(e){
		WritePassFail("Fail",e);
	  }
}

function getKeys()
{

	var prop = getPropertyObject();

	buffer += "<tr>"
	buffer += "<td>getKeys()</td>"
	buffer += "<td>Name, Type(nsISupports)</td>"

	try{

		netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");

		//prop.define("Name", Components.interfaces.nsIFile);
		WritePassFail("Fail","Test case not ready");
		//WritePassFail("Pass",1);
	 }
	 catch(e){
		WritePassFail("Fail",e);
	  }
}

function undefine()
{
   var prop = getPropertyObject();
	buffer += "<tr>"
	buffer += "<td>undefine()</td>"
	buffer += "<td>Name</td>"
   try{

		netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		prop.undefine("Name");
		WritePassFail("Pass","Undefine");
	 }
	 catch(e){
		WritePassFail("Fail",e);
	  }
}

</script>

</head>

<body>
<script type="text/javascript">
   RunAllTests();
</script>
</body>

</html>
