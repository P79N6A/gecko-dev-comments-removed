<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Test for Bug 341604</title>
  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"/>
</head>
<script type="application/javascript">
function doTest() {
  if (location.search == "?onreload") {
    try {
      window.parent.modify_if_8();
    } catch (error) {
      window.parent.postMessage({ok: true, desc: "allow-same-origin is no longer in effect after reload - parent access blocked."}, "*");
    }
  } else {
    window.parent.modify_if_8();
  }
}
</script>
<body onload="doTest()">
  I am sandboxed with 'allow-scripts' and 'allow-same-origin' the first time I am loaded, and with 'allow-scripts' the second time
</body>
</html>
