<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US">
<head>
  <title>TabCandy Page Change Tests</title>
  <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
  <link rel="icon" href="chrome://tabcandy/content/tabcandy.png"/>
</head>

<body>
  <script type="text/javascript;version=1.8" src="../../../js/optional/stacktrace.js"></script>
  <script type="text/javascript;version=1.8" src="../../../js/core/jquery.js"></script>
  <script type="text/javascript;version=1.8" src="../../../js/core/iq.js"></script>
  <script type="text/javascript;version=1.8" src="../../../js/core/utils.js"></script>
  <script type="text/javascript;version=1.8" src="../../../js/core/tabs.js"></script>
  <script type="text/javascript;version=1.8">
    
    Utils.log('it begins! -----------');
    
    Tabs.onFocus(function() {
      var focusTab = this;
      
      var sTime = Utils.getMilliseconds();
      Utils.log("Focus event. Timer starter:", sTime, '++++++++++');

      // If we switched to TabCandy window...
      if( focusTab.contentWindow == window ){
        Utils.log('focus');
/*         iQ.timeout(function() { */
          Utils.log('animation begins', Utils.getMilliseconds() - sTime);
          iQ('img').animate({
            width: 20,
            height: 20
          });
/*         }, 1); */
      } else {
        Utils.log('blur');
        $('img').css({
          left: 0,
          top: 0,
          width: window.innerWidth,
          height: window.innerHeight,
          position: 'absolute'
        });
      }
    });
    
    $('<img>')
      .appendTo('body')
      .attr('src', 'http://1.bp.blogspot.com/_NDcTbOyfDBE/SoWC5KWhOMI/AAAAAAAAAHA/cckSlOyUT6E/s400/whiskey_2.jpg')
      .css({
        left: 0,
        top: 0,
        width: window.innerWidth,
        height: window.innerHeight,
        position: 'absolute'
      });
      
  </script>  
</body>
</html>
