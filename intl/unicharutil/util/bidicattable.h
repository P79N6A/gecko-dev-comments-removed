










































#include "nscore.h" 

static PRUint8 gBidiCatIdx1[256] = {
     11,  
     16,  
     11,  
     17,  
     18,  
     19,  
      5,  
     20,  
     21,  
      1,  
      1,  
     22,  
     21,  
      1,  
      1,  
     23,  
     24,  
     11,  
     11,  
     11,  
     25,  
     26,  
     27,  
     28,  
      1,  
      1,  
     29,  
      1,  
      1,  
      1,  
     29,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     30,  
     31,  
      9,  
     31,  
      9,  
     32,  
     33,  
      9,  
      9,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     34,  
     35,  
     36,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     35,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     37,  
     38,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     39,  
     40,  
     10,  
     10,  
     10,  
     10,  
     41,  
     42,  
      2,  
      2,  
      2,  
      2,  
      2,  
      2,  
      2,  
     43,  
     44,  
     10,  
     45,  
      3,  
      3,  
      3,  
      3,  
      3,  
     46,  
     10,  
     47,  
      4,  
     48,  
     49,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
     50,  
     51,  
     52,  
     53,  
      5,  
     54,  
      3,  
     55,  
     56,  
      3,  
      3,  
      3,  
     10,  
     10,  
     10,  
     45,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
     50,  
     10,  
     49,  
      3,  
      2,  
      2,  
      2,  
      2,  
      2,  
     57,  
     58,  
     59,  
};

static PRUint8 gBidiCatIdx2[1376] = {
     60,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     61,  
     62,  
     63,  
     64,  
      1,  
     65,  
      1,  
      1,  
      1,  
     66,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     61,  
     64,  
     67,  
      1,  
      1,  
     65,  
      1,  
     68,  
      1,  
     60,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     61,  
     69,  
     70,  
     66,  
      1,  
      1,  
      1,  
     71,  
      1,  
     60,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     61,  
     72,  
     63,  
      1,  
      1,  
     65,  
      1,  
     73,  
      1,  
     66,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     74,  
     64,  
     67,  
     75,  
      1,  
     65,  
      1,  
      1,  
      1,  
     76,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     77,  
     67,  
      1,  
      1,  
      1,  
      1,  
     22,  
     78,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     79,  
     80,  
     81,  
     82,  
      1,  
     65,  
      1,  
      1,  
     83,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     61,  
      1,  
     84,  
      1,  
      1,  
     65,  
      1,  
     30,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     64,  
     67,  
      1,  
      1,  
     65,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     76,  
     85,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     86,  
     87,  
     88,  
     89,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     86,  
     90,  
      1,  
     91,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     38,  
      1,  
      1,  
     92,  
     93,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     62,  
     89,  
     94,  
      1,  
     10,  
     62,  
     10,  
     10,  
     10,  
     95,  
     75,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     96,  
     97,  
     98,  
      1,  
      1,  
      1,  
     99,  
     77,  
      1,  
     64,  
      1,  
    100,  
     67,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     88,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
    101,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    102,  
      1,  
      1,  
    103,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    104,  
      1,  
      1,  
      1,  
    104,  
      1,  
      1,  
      1,  
     65,  
      1,  
      1,  
      1,  
     65,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     88,  
     91,  
     75,  
     62,  
    105,  
    106,  
      1,  
      1,  
      9,  
    101,  
      9,  
    107,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     66,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    108,  
     77,  
     76,  
    109,  
    110,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    111,  
      9,  
      9,  
      9,  
      9,  
      1,  
      1,  
     88,  
     77,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    105,  
      1,  
      1,  
      1,  
      1,  
      1,  
    112,  
    113,  
     76,  
      1,  
      1,  
      1,  
      1,  
     37,  
    105,  
      1,  
     38,  
      1,  
      1,  
      1,  
    114,  
     38,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    115,  
    116,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     10,  
     10,  
     10,  
     10,  
     89,  
      1,  
      1,  
     79,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    117,  
    101,  
     32,  
      1,  
     32,  
      1,  
     32,  
      1,  
    118,  
     14,  
    119,  
      9,  
      9,  
      9,  
    120,  
    121,  
      9,  
    122,  
      9,  
      9,  
    123,  
    124,  
    125,  
    126,  
    127,  
      5,  
    127,  
      1,  
      1,  
      7,  
      7,  
    128,  
      1,  
      1,  
      1,  
     10,  
     10,  
     10,  
     10,  
     77,  
      1,  
    129,  
    101,  
    130,  
    131,  
    132,  
    133,  
      1,  
    134,  
    135,  
    136,  
     22,  
      9,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    137,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    138,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     22,  
      9,  
      9,  
    139,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
     83,  
      1,  
      1,  
      1,  
      9,  
    140,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      5,  
      5,  
    141,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     31,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    138,  
      9,  
    142,  
      9,  
    135,  
    143,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    144,  
    145,  
      9,  
      9,  
      9,  
    146,  
      9,  
      9,  
      9,  
    132,  
    147,  
     83,  
    146,  
      9,  
      9,  
      9,  
      9,  
      9,  
    135,  
      9,  
      9,  
      9,  
    146,  
     83,  
      9,  
    148,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    135,  
    135,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     32,  
    140,  
      1,  
    146,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     10,  
     10,  
     10,  
     10,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
     21,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
    149,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    143,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    138,  
      1,  
      1,  
      1,  
      9,  
    143,  
    150,  
      9,  
      9,  
      9,  
     21,  
    151,  
    131,  
     32,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    152,  
     21,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    153,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
    143,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    118,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      1,  
      1,  
      1,  
    154,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    146,  
      9,  
      1,  
    155,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     29,  
    140,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    111,  
      1,  
      1,  
      1,  
     29,  
};

static PRUint8 gBidiCatIdx3[8] = {
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
};

static PRUint8 gBidiCatIdx4[336] = {
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
     83,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     32,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     88,  
    156,  
    157,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
    101,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     21,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    158,  
    159,  
      1,  
      1,  
     82,  
    143,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    155,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     61,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     79,  
     91,  
      1,  
      1,  
     88,  
     10,  
     38,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    160,  
     98,  
      1,  
    159,  
     61,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
};

static PRUint8 gBidiCatIdx5[276] = {
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    161,  
      2,  
    162,  
      2,  
      2,  
      2,  
      2,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
    163,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
    164,  
     10,  
     10,  
      9,  
    101,  
     89,  
      1,  
      9,  
      9,  
      9,  
      9,  
    165,  
    166,  
    167,  
    168,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
      3,  
     55,  
    169,  
     19,  
      5,  
     20,  
     21,  
      1,  
      1,  
     22,  
     21,  
      1,  
      1,  
     22,  
    138,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    170,  
     83,  
      1,  
    171,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    172,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    140,  
      9,  
    143,  
};

static PRUint8 gBidiCatIdx6[6] = {
      1,  
      1,  
      1,  
      1,  
      1,  
     67,  
};

static PRUint8 gBidiCatIdx7[80] = {
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
};

static PRUint8 gBidiCatIdx8[8] = {
      2,  
      2,  
      2,  
      2,  
      2,  
      2,  
      2,  
      2,  
};

static PRUint8 gBidiCatIdx9[8] = {
      2,  
      2,  
      2,  
    173,  
      2,  
      2,  
      2,  
      2,  
};

static PRUint8 gBidiCatIdx10[12] = {
    174,  
    175,  
      2,  
      2,  
      2,  
      2,  
      2,  
    176,  
      2,  
      2,  
      2,  
      2,  
};

static PRUint8 gBidiCatIdx11[144] = {
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
};

static PRUint8 gBidiCatIdx12[256] = {
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     88,  
     38,  
    177,  
    178,  
    179,  
    105,  
      1,  
      1,  
      1,  
    114,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    180,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
     83,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
    181,  
      5,  
      5,  
      5,  
      5,  
      5,  
      5,  
};

static PRUint8 gBidiCatIdx13[64] = {
      9,  
      9,  
      9,  
      9,  
      9,  
    143,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
      9,  
    143,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
};

static PRUint8 gBidiCatIdx14[68] = {
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
};

static PRUint8 gBidiCatIdx15[64] = {
    182,  
      1,  
      1,  
      1,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
     11,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
      1,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
     10,  
      1,  
      1,  
};

static PRUint32 gBidiCatPat[183] = {
    0x00000000,  
    0x11111111,  
    0x22222222,  
    0x33333333,  
    0x44444444,  
    0x55555555,  
    0x66666666,  
    0x77777777,  
    0x88888888,  
    0x99999999,  
    0xAAAAAAAA,  
    0xBBBBBBBB,  
    0xCCCCCCCC,  
    0xDDDDDDDD,  
    0xEEEEEEEE,  
    0xFFFFFFFF,  
    0xBBCEDCDB,  
    0xDCCCBBBB,  
    0x9977799E,  
    0x88686999,  
    0x99999855,  
    0x11111119,  
    0x99999111,  
    0xB9999111,  
    0xBBCBBBBB,  
    0x99777798,  
    0x99B99199,  
    0x99195577,  
    0x99999159,  
    0x91111111,  
    0x11111991,  
    0x99999911,  
    0x99911111,  
    0x91999999,  
    0x11991111,  
    0x19111111,  
    0x91991111,  
    0xAAAAA111,  
    0x111111AA,  
    0x11111911,  
    0xAAAAAAA2,  
    0xA2AAAAAA,  
    0xA2AA2AA2,  
    0x99334444,  
    0x99383773,  
    0x33333AAA,  
    0xAAAAA333,  
    0x3AAAAAAA,  
    0x33344744,  
    0x3333333A,  
    0xAA333333,  
    0xAA4AAAAA,  
    0xA33AAAAA,  
    0x33AAAA9A,  
    0x33333355,  
    0xB3333333,  
    0x333333A3,  
    0xAAAAA222,  
    0x9922AAAA,  
    0x22222299,  
    0x11111AA1,  
    0x111A1111,  
    0xAAAAAAA1,  
    0x11A1111A,  
    0x111AAAA1,  
    0x1111AA11,  
    0x111111A1,  
    0x11A11111,  
    0x11117711,  
    0xA1111AA1,  
    0x11AAA11A,  
    0x11A111AA,  
    0xA1AAAAA1,  
    0x11111171,  
    0xA11A1111,  
    0x1A111111,  
    0x11111A11,  
    0x1111111A,  
    0x11111979,  
    0xAA111111,  
    0xAA11111A,  
    0x11AAAA1A,  
    0x1AA11111,  
    0x19999999,  
    0x11AA1111,  
    0x1A1AAA11,  
    0xAAAA11A1,  
    0x71111AAA,  
    0xA1111111,  
    0x1AAAAAAA,  
    0x111AA1AA,  
    0x11AAAAAA,  
    0xA1A11111,  
    0x119999A1,  
    0xAA1AAAAA,  
    0x111AAAAA,  
    0xAAA11111,  
    0xAAAAAA1A,  
    0x1AA11AA1,  
    0xAA1111AA,  
    0x1AA11A11,  
    0x11111199,  
    0x1111111E,  
    0x11199111,  
    0x111AAA11,  
    0x1111AAAA,  
    0x11A17111,  
    0x1EAAA999,  
    0xA1111AAA,  
    0x1111AAA1,  
    0x11991119,  
    0x99111111,  
    0xAA1A1111,  
    0x111A1AAA,  
    0x11AAAA11,  
    0xAAAA1111,  
    0xAA11AAAA,  
    0x91911111,  
    0x19911111,  
    0x21BBBEEE,  
    0x8FFFFFCE,  
    0x99977777,  
    0x99989999,  
    0xE9999999,  
    0x111BBBBB,  
    0xBBBBBB11,  
    0x55551115,  
    0x19996655,  
    0x11777777,  
    0x19999199,  
    0x99191111,  
    0x99111119,  
    0x91919999,  
    0x17111191,  
    0x11119911,  
    0x11199999,  
    0x11999911,  
    0x99997699,  
    0x11999999,  
    0x99199999,  
    0x11111999,  
    0x11115555,  
    0x99919999,  
    0x11119999,  
    0x99199991,  
    0x99991199,  
    0x99999991,  
    0x19111999,  
    0x11191999,  
    0x99999199,  
    0x1119999E,  
    0xAAAAAA11,  
    0x11199AA1,  
    0x11119111,  
    0x19991111,  
    0x99991111,  
    0x11119AAA,  
    0x99AA1111,  
    0x1A111A11,  
    0x1111A111,  
    0x1AAAAAA1,  
    0x2A211111,  
    0x22222262,  
    0x99333333,  
    0x33933333,  
    0x99891898,  
    0x79999999,  
    0x19996699,  
    0x11119779,  
    0x99777991,  
    0x17799977,  
    0x11999991,  
    0x11111191,  
    0x92222222,  
    0x2AA2AAA2,  
    0xAAAA2222,  
    0xA2222AAA,  
    0xBBBBB111,  
    0xAAAAABBB,  
    0xAAA11AAA,  
    0x119AAA99,  
    0x55111111,  
    0x111111B1,  
};

static eBidiCategory GetBidiCat(PRUint32 u)
{
    PRUint32 pat;
    PRUint16 patidx;

       

    
    if (u<=((PRUint32)0x07FF)) {
        patidx = gBidiCatIdx1 [( u  >> 3 )];
    }

    
    else if ((((PRUint32)0x0900)<=u)&&(u<=((PRUint32)0x33FF))) {
        patidx = gBidiCatIdx2 [( (u -(PRUint32) 0x0900) >> 3 )];
    }

    
    else if ((((PRUint32)0x4DC0)<=u)&&(u<=((PRUint32)0x4DFF))) {
        patidx = gBidiCatIdx3 [( (u -(PRUint32) 0x4DC0) >> 3 )];
    }

    
    else if ((((PRUint32)0xA000)<=u)&&(u<=((PRUint32)0xAA7F))) {
        patidx = gBidiCatIdx4 [( (u -(PRUint32) 0xA000) >> 3 )];
    }

    
    else if ((((PRUint32)0xF900)<=u)&&(u<=((PRUint32)0x1019F))) {
        patidx = gBidiCatIdx5 [( (u -(PRUint32) 0xF900) >> 3 )];
    }

    
    else if ((((PRUint32)0x101D0)<=u)&&(u<=((PRUint32)0x101FF))) {
        patidx = gBidiCatIdx6 [( (u -(PRUint32) 0x101D0) >> 3 )];
    }

    
    else if ((((PRUint32)0x10280)<=u)&&(u<=((PRUint32)0x104FF))) {
        patidx = gBidiCatIdx7 [( (u -(PRUint32) 0x10280) >> 3 )];
    }

    
    else if ((((PRUint32)0x10800)<=u)&&(u<=((PRUint32)0x1083F))) {
        patidx = gBidiCatIdx8 [( (u -(PRUint32) 0x10800) >> 3 )];
    }

    
    else if ((((PRUint32)0x10900)<=u)&&(u<=((PRUint32)0x1093F))) {
        patidx = gBidiCatIdx9 [( (u -(PRUint32) 0x10900) >> 3 )];
    }

    
    else if ((((PRUint32)0x10A00)<=u)&&(u<=((PRUint32)0x10A5F))) {
        patidx = gBidiCatIdx10 [( (u -(PRUint32) 0x10A00) >> 3 )];
    }

    
    else if ((((PRUint32)0x12000)<=u)&&(u<=((PRUint32)0x1247F))) {
        patidx = gBidiCatIdx11 [( (u -(PRUint32) 0x12000) >> 3 )];
    }

    
    else if ((((PRUint32)0x1D000)<=u)&&(u<=((PRUint32)0x1D7FF))) {
        patidx = gBidiCatIdx12 [( (u -(PRUint32) 0x1D000) >> 3 )];
    }

    
    else if ((((PRUint32)0x1F000)<=u)&&(u<=((PRUint32)0x1F1FF))) {
        patidx = gBidiCatIdx13 [( (u -(PRUint32) 0x1F000) >> 3 )];
    }

    
    else if ((((PRUint32)0x2F800)<=u)&&(u<=((PRUint32)0x2FA1F))) {
        patidx = gBidiCatIdx14 [( (u -(PRUint32) 0x2F800) >> 3 )];
    }

    
    else if ((((PRUint32)0xE0000)<=u)&&(u<=((PRUint32)0xE01FF))) {
        patidx = gBidiCatIdx15 [( (u -(PRUint32) 0xE0000) >> 3 )];
    }

    else {
      



      if (((u >= 0x0590) && (u <= 0x05FF)) ||
          ((u >= 0x07C0) && (u <= 0x08FF)) ||
          ((u >= 0xFB1D) && (u <= 0xFB4F)) ||
          ((u >= 0x10800) && (u <=0x10FFF)))
         return eBidiCat_R;
      else if (((u >= 0x0600) && (u <= 0x07BF)) ||
               ((u >= 0xFB50) && (u <= 0xFDFF)) ||
               ((u >= 0xFE70) && (u <= 0xFEFE)))
         return eBidiCat_AL;
      else
        return eBidiCat_L;
    }

    if (patidx < 0x10)
        return (eBidiCategory)patidx;
    else {
        pat = gBidiCatPat[patidx];
        return (eBidiCategory)((pat  >> ((u % 8) * 4)) & 0x0F);
    }
}


