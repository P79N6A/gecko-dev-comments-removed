





"use strict";

do_get_profile(); 
const certdb = Cc["@mozilla.org/security/x509certdb;1"]
                 .getService(Ci.nsIX509CertDB);

function cert_from_file(filename) {
  let der = readFile(do_get_file("test_cert_eku/" + filename, false));
  return certdb.constructX509(der, der.length);
}

function load_cert(cert_name, trust_string) {
  var cert_filename = cert_name + ".der";
  addCertFromFile(certdb, "test_cert_eku/" + cert_filename, trust_string);
  return cert_from_file(cert_filename);
}

function check_cert_err_generic(cert, expected_error, usage) {
  do_print("cert cn=" + cert.commonName);
  do_print("cert issuer cn=" + cert.issuerCommonName);
  let hasEVPolicy = {};
  let verifiedChain = {};
  let error = certdb.verifyCertNow(cert, usage,
                                   NO_FLAGS, verifiedChain, hasEVPolicy);
  
  
  if (expected_error != -1 ) {
    do_check_eq(error,  expected_error);
  } else {
    do_check_neq (error, 0);
  }
}

function check_ok_ca(cert) {
  return check_cert_err_generic(cert, 0, certificateUsageSSLCA);
}

function check_ok_ee(cert, usage) {
  return check_cert_err_generic(cert, 0, usage);
}

function run_test_in_mode(useMozillaPKIX) {
  Services.prefs.setBoolPref("security.use_mozillapkix_verification",
                             useMozillaPKIX);

  check_cert_err_generic(load_cert('int-EKU-CA', ',,'), useMozillaPKIX ? -1 : 0, certificateUsageSSLCA) ;
  check_ok_ee(cert_from_file('ee-EKU-CA-int-EKU-CA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_NS-int-EKU-CA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_TS-int-EKU-CA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-CA_EP', ',,'), useMozillaPKIX ? -1 : 0, certificateUsageSSLCA) ;
  check_ok_ee(cert_from_file('ee-EKU-CA-int-EKU-CA_EP.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-CA_EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-CA_EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  load_cert('int-EKU-CA_EP_NS_OS_SA_TS', ',,');
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_EP_NS_OS_SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-CA_NS', ',,'));
  check_ok_ee(cert_from_file('ee-EKU-CA-int-EKU-CA_NS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_NS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_NS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_NS.der'), certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_NS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_NS.der'), certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-CA_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-CA_OS', ',,'), useMozillaPKIX ? -1 : 0, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_ok_ee(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_ok_ee(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-CA_SA', ',,'));
  check_ok_ee(cert_from_file('ee-EKU-CA-int-EKU-CA_SA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_SA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_SA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_SA.der'), certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_SA.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_SA.der'), certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-CA_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-CA_TS', ',,'), useMozillaPKIX ? -1 : 0, certificateUsageSSLCA) ;
  check_ok_ee(cert_from_file('ee-EKU-CA-int-EKU-CA_TS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_TS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_TS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_TS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_TS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-CA_TS.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-CA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-EP', ',,'), useMozillaPKIX ? -1 : -1, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-EP_NS', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_NS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_NS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP_NS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP_NS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_NS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_NS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_NS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_NS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_NS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_NS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_NS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_NS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-EP_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-EP_OS', ',,'), useMozillaPKIX ? -1 : -1, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-EP_SA', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_SA.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_SA.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP_SA.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP_SA.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_SA.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_SA.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_SA.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_SA.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_SA.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_SA.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_SA.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_SA.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-EP_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-EP_TS', ',,'), useMozillaPKIX ? -1 : -1, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_TS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_TS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP_TS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-EP_TS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_TS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_TS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_TS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_TS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_TS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_TS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_TS.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-EP_TS.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-EP_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-NONE', ',,'));
  check_ok_ee(cert_from_file('ee-EKU-CA-int-EKU-NONE.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-NONE.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-NONE.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP-int-EKU-NONE.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_NS-int-EKU-NONE.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NONE.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_OS-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-NONE.der'), certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-NONE.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-CA_TS-int-EKU-NONE.der'), certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-NONE.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP-int-EKU-NONE.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NONE.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-NONE.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_NS-int-EKU-NONE.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-EP_OS-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-NONE.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-NONE.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-NONE.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-NONE.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-EP_TS-int-EKU-NONE.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NONE.der'), certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NONE.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NONE.der'), certificateUsageEmailSigner);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NONE.der'), certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NONE.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-NS_OS-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-NONE.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NONE.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NONE.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_SA-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_TS-int-EKU-NONE.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-NONE.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-NONE.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NONE.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NONE.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-NS', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-NS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  load_cert('int-EKU-NS_OS', ',,');
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_ok_ee(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_ok_ee(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_OS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_OS.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-NS_SA', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NS_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-NS_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-NS_TS', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-NS_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-NS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-NS_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-NS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-OS', ',,'), useMozillaPKIX ? -1 : -1, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  load_cert('int-EKU-OS_SA', ',,');
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_ok_ee(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_ok_ee(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_ok_ee(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_SA.der'), certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-OS_TS', ',,'), useMozillaPKIX ? -1 : -1, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-OS_TS.der'), useMozillaPKIX? 0 : -1, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-OS_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-SA', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-SA.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_ok_ca(load_cert('int-EKU-SA_TS', ',,'));
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-CA_SA-int-EKU-SA_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-EP_SA-int-EKU-SA_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NONE-int-EKU-SA_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : -1, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-NS_SA-int-EKU-SA_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA_TS.der'), useMozillaPKIX? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-SA_TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA-int-EKU-SA_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_ok_ee(cert_from_file('ee-EKU-SA_TS-int-EKU-SA_TS.der'), certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA_TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-SA_TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);

  check_cert_err_generic(load_cert('int-EKU-TS', ',,'), useMozillaPKIX ? -1 : -1, certificateUsageSSLCA) ;
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_EP_NS_OS_SA_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_OS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-CA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  }
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-EP_OS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-EP_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NONE-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_OS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-NS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  if (useMozillaPKIX) {
    check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  }
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-OS_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-TS.der'), useMozillaPKIX ? SEC_ERROR_INADEQUATE_CERT_TYPE : 0, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-SA_TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLClient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageSSLServer);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-TS.der'), -1, certificateUsageSSLCA);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailSigner);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageEmailRecipient);
  check_cert_err_generic(cert_from_file('ee-EKU-TS-int-EKU-TS.der'), SEC_ERROR_INADEQUATE_CERT_TYPE, certificateUsageStatusResponder);
}

function run_test() {
  load_cert("ca", "CT,CT,CT");

  run_test_in_mode(true);
  run_test_in_mode(false);
}
